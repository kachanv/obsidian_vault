Модульные тесты
![[screenshot_2025-07-17 21-52-22.png]]

* юнит/модуль - код, выполняющий строго определенную функцию изолированно от остальных. Для имитации могут быть использованны моки и стабы
* тестирование проводят пока на модуль не влияет остальное окружение т.е. изолированно
* тестирование можно провести сразу (до или после написания кода)
* тест должен быть быстрым - исполняться быстро, тратить минимум ресурсов
* разные юниты можно тестировать одновременно
* тест должен быть детерминированным - возвращать один результат при одних вводных
* один тест проверят конкретный кейс
также выделяют:
* *интеграционные* тесты - взаимодействие нескольких юнитов
* *сквозные тесты (End-to-end tests)* - взаимодействие многих юнитов друг с другом (сервисов). Прогон сценариев

**Шаблон теста**
* подготовка входных данных/моков/стабов
	* должны быть протестиированы граничные условия
* испольнение модуля
* проверка результатов

## Pytest
* в проекте создаются файлы py с преффиксом *test_*
* в этих файлах пишутся функции с префиксом *test_* и проверками *assert*
* **pytest** запускается как bash команда в папке проекта, прогоняет все тесты, выводит результат
* декоратором `@pytest.fixture` помечаются f-ии, подготавливающие данные для тестов
```python
import pytest

@pytest.fixture
def numbers():
    return [1, 2, 3]

def test_sum(numbers):
    assert sum(numbers) == 6
```
* декоратором `pytest.mark.parametrize` помечаются параметризированные тесты - аргументы из декоратор поименно передаются в f-ю
```python
@pytest.mark.parametrize("a, b, expected", [(1, 2, 3), (4, 5, 9)])
def test_add(a, b, expected):
    assert a + b == expected
```

### Mocking
`import pytest-mock`
создание поддельных объектов для изоляции модулей в unit тестировании: API, БД, и всем с чем взаимодействует функция
