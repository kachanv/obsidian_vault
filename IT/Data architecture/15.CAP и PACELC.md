# CAP
теорема Брюера, 2000
Появилась, когда разработчики столкнулись с необходимостью обрабатывать данные распределенно и как следствие с тем, что это невозможно делать с теми же гарантиями что в монолитных системах.
**Опр:**  в распределенной системе возможно одновременно обеспечить полное выполнение только 2-х из 3-х принципов:
* *Consistency* - все копии данных в системе имели одинаковую информацию в любой момент времени. Линеаризуемость.
* *Availability* - система способна отвечать на запросы пользователей и *обновлять* данные в любое время, даже при наличии сбоев или неполадок в системе
* *Partition Tolerance* - система способна продолжать работу даже при потере связи между отдельными компонентам. Устойчивость к нарушению связности сети.
![[Pasted image 20241210224419.png|400x300]]
Принадлежность СУБД к конкретному углу графа очень уловно т.к. всё зависит от конфигурации.
далее подробнее о каждом
## Consistency
* двухфазный коммит
* синхронная репликация
## Availability
* репликация, зеркалирование, горячий резерв
* подруземеват полную доступность данных, не частичную. Имеется ввиду полнота данных и полная функцилнальность
## Partition Tolerance
* система продолжает работать даже в том случае, если сеть столкнется с проблемами связности, и узлы временно перестанут обмениваться данными
* механизм кворума
* алгоритм *Vector Clocks*
* речь о временном разделении и корректном последующем восстановлении
## Критика
* CAP не предусматривает время ответа (Latency)
* изначально для очень простой технической системы (семафор/лампочка/бинрный счетчик)
* CAP не подходит для больших сложных систем
* классический CAP - для максимально атомарного звена системы, нельзя рассматривать взаимодествие систем, только по отдельности.
* Клепман раскритиковал классификацию по CAP
* есть упрощение до CP теоремы, всё сводится к вопросу нужна ли строгая согласованность, если да то: *CP* - узлы отключены пока не появится связь, если нет то *AP* - узлы обрабатывают запросы без связи, но теряется согласованность.
# PACELC
2012
- PACELC: P, then A or C, else L or C
- теорема PACELC заявляет, что необходимо идти на компромисс между задержками и консистентностью даже при отсутствии разделения
- (L)atency – общее время задержки от момента выполнения действия пользователем до момента предоставления ему результата
- при наличии сетевого разделения (P) система может выбрать одно из двух: доступность (A) или консистентность (С), иначе (E)lse, если сетевого разделения нет, система может выбрать одно из двух: время задержки (L) или консистентность (С).
- Если система полностью ACID то она PC/EC
- Если система делает упор на сохранение доступности и производительности, она PA/EL - в случае разрыва сети распадается на группы и продолжает обрабатывать запросы. В случе восстановления сети, миниминизирует Latency жертвуя Consistency. Например интернет магазины и соцсети.